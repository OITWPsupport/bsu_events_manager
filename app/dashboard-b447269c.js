!function(){"use strict";angular.module("eventsAdminApp",["sharedResources","mgcrea.ngStrap"]).filter("filterCategories",function(){return function(e,t){if(e){var n=[];return angular.forEach(e,function(e){e.parent==t&&e.name!=t&&n.push(e)}),n}}})}(),function(){"use strict";angular.module("eventsAdminApp").directive("formHandler",["$timeout","anchorSmoothScroll",function(e,t){return{scope:{formHandlerCallback:"&"},restrict:"A",link:function(n,r){r.on("submit",function(){var i=angular.element(r[0].querySelector(".ng-invalid-required"))[0];i?t.scrollTo(i):(n.formHandlerCallback(),e(function(){t.scrollToTop()},1500))})}}}])}(),function(){"use strict";angular.module("eventsAdminApp").directive("newEventForm",["PLUGIN_ROOT","$modal","$alert","appService","calendarService",function(e,t,n,r,i){return{templateUrl:e+"/templates/dashboard/newEventForm.html",link:function(a){function o(){a.newEventForm.$setPristine(),a.event=i.getEmptyEvent(),a.event.type="Fitness",a.event.repeat.ends.type="",a.iconUrl="",a.loading=!1,a.addingEvent=!1,a.submitted=!1}a.calendarTypes=[],a.locations=[],a.staticCategories=[],a.fieldTypes=["Turf Field","Grass Field"],a.event={iconUrl:"",ends:{type:""}},r.runOnLoad().then(function(e){a.icons=e.icons,a.settings=e,a.locations=e.locations,a.staticCategories=e.staticCategories,i.init(e),a.calendarTypes=i.calendarTypes(),o()});var s=t({placement:"center",title:"Select Unique Icon",contentTemplate:e+"/templates/dashboard/iconsModal.html",show:!1,scope:a,animation:"am-fade",backdropAnimation:"am-fade"});a.showIcons=function(){s.show()},a.selectIcon=function(e){s.toggle(),e?(a.event.iconUrl=e.url.replace("http:","").replace("https:",""),a.selectedIconName=e.name):(a.event.iconUrl=void 0,a.selectedIconName=void 0)},a.toggle=function(e,t){var n=a;angular.forEach(e.split("."),function(e){n=n[e]});var r=n.indexOf(t);r>-1?n.splice(r,1):n.push(t)},a.registrationRequired=function(e){e||(a.event.registration.deadline=""),a.event.registration.required=e},a.addEvent=function(){a.submitted=!0,a.addingEvent=!0,"Fields"==a.event.type&&void 0!==a.event.fieldType&&(a.event.location=a.event.fieldType),i.create(a.event).then(function(){a.addingEvent=!1,n({title:"Success",content:"Event was successfully added.",type:"success",show:!0,duration:10,container:"#alerts-container"}),o()},function(){a.addingEvent=!1,n({title:"Error",content:"There was an error adding event.",type:"danger",show:!0,duration:10,container:"#alerts-container"})})},a.$watch("event.type",function(e){void 0!==e&&(a.event.categories=[e])}),a.$watch("event.startDate",function(e,t){void 0!==e&&e!=t&&(a.event.endDate&&t!=a.event.endDate||(a.event.endDate=e))})}}}])}(),function(){"use strict";angular.module("eventsAdminApp").directive("shortcodeForm",["PLUGIN_ROOT",function(e){return{templateUrl:e+"/templates/dashboard/shortcodeForm.html",link:function(e){e.loading=!1,e.selectedCategories=[],e.viewType="",e.shortcode="",e.weekDefault="",e.viewTypes=[{name:"Dropins List",value:"dropins"},{name:"Registration Deadlines",value:"deadlines"},{name:"Week Calendar",value:"calendar"},{name:"Week List",value:"list"},{name:"Trips",value:"trips"},{name:"Outdoor Clinics",value:"clinics"},{name:"Fields",value:"fields"},{name:"Details page",value:"details"}],e.createShortcode=function(){if(""!==e.viewType){e.shortcode="";var t=[];angular.forEach(e.selectedCategories,function(e){e=e.replace("-",""),t.push(e.trim())}),"details"==e.viewType?e.shortcode='[bsu_events_manager view="details"]':"deadlines"==e.viewType?e.shortcode='[bsu_events_manager categories="Registration" view="deadlines"]':"trips"==e.viewType?e.shortcode='[bsu_events_manager categories="Trips" view="trips"]':"clinics"==e.viewType?e.shortcode='[bsu_events_manager categories="Clinics" view="clinics"]':"fields"==e.viewType?e.shortcode='[bsu_events_manager categories="Fields" view="fields"]':"both"!=e.viewType&&t.length>0?e.shortcode='[bsu_events_manager categories="'+t+'" view="'+e.viewType+'"]':t.length>0&&(e.shortcode='[bsu_events_manager categories="'+t+'" view="both"]')}}}}}])}(),function(){"use strict";angular.module("eventsAdminApp").directive("times",function(){return{scope:{time:"="},link:function(e){e.hoursList=[1,2,3,4,5,6,7,8,9,10,11,12],e.minutesList=["00",5,10,15,20,25,30,35,40,45,50,55],e.amPmList=["am","pm"],e.hours=8,e.minutes="00",e.amPm="am",e.$watch("[hours,minutes,amPm]",function(){e.time=e.hours+":"+e.minutes+e.amPm},!0)},template:'<select class="time" ng-model="hours" ng-options="hour for hour in hoursList"></select><select class="time" ng-model="minutes" ng-options="minute for minute in minutesList"></select><select class="time" ng-model="amPm" ng-options="which for which in amPmList"></select>'}})}(),function(){"use strict";angular.module("eventsAdminApp").service("calendarService",["$q","googleApiService","oAuthService","eventService",function(e,t,n,r){function i(e){var t="";return angular.forEach(o.calendars,function(n){n.name==e&&(t=n.id)}),t}function a(e,n){var r=i(e);return t.createEvent(r,n)}var o;this.init=function(e){o=e,n.init(o)},this.calendarTypes=function(){var e=[];return angular.forEach(o.calendars,function(t){"Registration"!=t.name&&e.push(t.name)}),e},this.getEmptyEvent=function(){return r.getEmptyEvent()},this.create=function(t){var i=r.formatForDashboard(t),o=e.defer();return n.checkAuth(function(){a(t.type,i).then(function(){if(t.registration.required===!0){var e=r.formatRegistration(t);a("Registration",e).then(function(){o.resolve()})}else o.resolve()},function(){o.reject()})}),o.promise}}])}(),function(){"use strict";angular.module("eventsAdminApp").service("oAuthService",["$rootScope","googleApiService",function(e,t){var n,r,i,a=["https://www.googleapis.com/auth/calendar"],o=!1;this.init=function(e){n=e,t.authorize({client_id:n.clientId,scope:a,immediate:!0},function(e){r=e.access_token,i=e.client_id,e&&!e.error&&(o=!0)})},this.checkAuth=function(e){var r={client_id:n.clientId,scope:a,immediate:o};return t.checkAuth(r,function(t){t&&!t.error&&e()})}}])}(),function(){"use strict";angular.module("sharedResources",[]).constant("PLUGIN_ROOT","/wp-content/plugins/bsu_events_manager").constant("SEPARATOR","\n\n------------------------------\n").constant("AT_SIGN_REPLACEMENT","%%at%%").constant("FIELDS",{CATEGORIES:"Categories: ",DETAILS_URL:"Details URL: ",FEE:"Fee: ",RECTRAC_URL:"Registration URL: ",REGISTRATION_URL:"Registration URL: ",REGISTRATION_DEADLINE:"Registration deadline: ",DATE_DESCRIPTION:"Date description: ",FIELD_TYPE:"Field type: ",UNIQUE_ICON_URL:"Unique icon url: ",START_DATE_TIME:"Event start datetime: ",END_DATE_TIME:"Event end datetime: ",OTHER_LOCATION:"Location: ",TRIP_INCLUDES:"Trip includes: ",PACKING_LIST:"Packing list: "}).filter("unique",function(){return function(e,t){var n=[],r=[];return angular.forEach(e,function(e){var i=e;angular.forEach(t.split("."),function(e){i=i[e]}),-1===r.indexOf(i)&&(r.push(i),n.push(e))}),n}})}(),function(){"use strict";angular.module("sharedResources").controller("MainCtrl",["$scope","$timeout","appService",function(e,t,n){function r(){t(function(){void 0===gapi||void 0===gapi.client||void 0===gapi.client.setApiKey?r():n.appIsLoaded()},5)}var i;e.categories=[],e.init=function(t){i=angular.fromJson(t),e.loading=!1,e.categories=i.categories.all,e.view=i.view,e.detailsPage=i.detailsPage,e.calendarId=i.calendarId,e.eventId=i.eventId,e.settings=i,n.init(i),r()}}])}(),function(){"use strict";angular.module("sharedResources").directive("loading",function(){return{template:'<div class="bsuEventSpinner"></loading>'}})}(),function(){"use strict";angular.module("sharedResources").directive("selectOnClick",function(){return{restrict:"A",link:function(e,t){t.on("click",function(){this.select()})}}})}(),function(){"use strict";angular.module("sharedResources").service("anchorSmoothScroll",["$document","$window",function(e,t){function n(e,t){return e.pageYOffset?e.pageYOffset:t.documentElement&&t.documentElement.scrollTop?t.documentElement.scrollTop:t.body.scrollTop?t.body.scrollTop:0}function r(e,t){for(var n=t.offsetTop,r=t;r.offsetParent&&r.offsetParent!=e.body;)r=r.offsetParent,n+=r.offsetTop;return n}function i(e,t,n,r){for(var i=0,a=Math.round(r/25),o=e+a,s=e;t>s;s+=a)setTimeout("window.scrollTo(0, "+o+")",i*n),o+=a,o>t&&(o=t),i++}function a(e,t,n,r){for(var i=0,a=Math.round(r/25),o=e-a,s=e;s>t;s-=a)setTimeout("window.scrollTo(0, "+o+")",i*n),o-=a,t>o&&(o=t),i++}var o=e[0],s=t,c=this;this.scrollToTop=function(){c.scrollTo(o.getElementsByTagName("head")[0])},this.scrollTo=function(e){if(e){var t=n(s,o),c=r(o,e),l=c>t?c-t:t-c;if(100>l)this.scrollToTop(c);else{var u=Math.round(l/80),d=u>20?20:u;c>t?i(t,c,d,l):a(t,c,d,l)}}}}])}(),function(){"use strict";angular.module("sharedResources").service("appService",["$http","$q","googleApiService","PLUGIN_ROOT","AT_SIGN_REPLACEMENT",function(e,t,n,r,i){function a(){var e=[];angular.forEach(o.categories.all,function(t){e.push({name:t.name,parent:t.name}),angular.forEach(t.children,function(n){e.push({name:n,parent:t.name})})}),o.calendarId&&(o.calendarId=o.calendarId.replace(i,"@"));var r=o.categories.view,a=[];void 0!==r&&r.length>0&&(a="all"===r?e:r.split(","));var s={categories:e,view:a,calendarId:o.calendarId,eventId:o.eventId,clientId:o.clientId,detailsPage:o.detailsPage,calendars:o.calendars,eventTypes:o.eventTypes,locations:o.locations,staticCategories:o.staticCategories};void 0!==o.icons&&(s.icons=o.icons),n.init(o);var c=t.defer();return c.resolve(s),c.promise}var o,s=t.defer();this.init=function(e){o=e},this.runOnLoad=function(){return s.promise},this.appIsLoaded=function(){s.resolve(a())}}])}(),function(){"use strict";angular.module("sharedResources").service("dateService",function(){function e(e){return 10>e?"0"+e:e}this.getDateString=function(e,t,n){void 0===t&&(t="YYYY-MM-DD");var r=moment(e,["MM/DD/YYYY"]).format(t);return void 0!==n&&(r+="Z"),r},this.getDateTimeString=function(t,n){var r=moment().isDST()?"-06:00":"-07:00";return moment(e(t)+e(n),["MM/DD/YYYY h:mma"]).format("YYYY-MM-DDTHH:mm:ss"+r)},this.getDaysString=function(e){var t=[];return angular.forEach(e,function(e){switch(e){case"MO":t.push("M");break;case"TU":t.push("Tu");break;case"WE":t.push("W");break;case"TH":t.push("Th");break;case"FR":t.push("F");break;case"SA":t.push("Sa");break;case"SU":t.push("Su")}}),t.join("/")}})}(),function(){"use strict";angular.module("sharedResources").service("eventService",["dateService","FIELDS","SEPARATOR","AT_SIGN_REPLACEMENT",function(e,t,n,r){function i(t){var n={timeZone:"America/Boise"};return t.allDay===!0?n.date=e.getDateString(t.startDate):n.dateTime=e.getDateTimeString(t.startDate,t.startTime),n}function a(t){var n={timeZone:"America/Boise"};return t.allDay===!0?n.date=e.getDateString(t.endDate):n.dateTime=e.getDateTimeString(t.endDate,t.endTime),n}function o(e){var r=[];if(e.categories.length>0&&r.push(t.CATEGORIES+e.categories.toString().replace(/- /g,"")),null!==e.detailsUrl&&r.push(t.DETAILS_URL+e.detailsUrl),r.push(null!==e.fee?[void 0,0,"$0","free","Free"].indexOf(e.fee)>-1?t.FEE+"Free":t.FEE+"$"+e.fee.replace("$",""):t.FEE+"free"),null!==e.recTracId){var i="https://reconline.boisestate.edu/wbwsc/webtrac.wsc/wbsearch.html?xxsearch=yes&xxactivitynumber="+e.recTracId;r.push(t.RECTRAC_URL+i)}if(e.registration.required===!0&&r.push(t.REGISTRATION_DEADLINE+e.registration.deadline),e.dateDescription){var a=e.dateDescription.replace(/\n/g,E);r.push(t.DATE_DESCRIPTION+a)}return e.fieldType&&r.push(t.FIELD_TYPE+e.fieldType),e.iconUrl&&r.push(t.UNIQUE_ICON_URL+e.iconUrl),e.registration.required&&(r.push(t.START_DATE_TIME+e.startDate+" "+e.startTime),r.push(t.END_DATE_TIME+e.endDate+" "+e.endTime)),e.otherLocationDescription&&r.push(t.OTHER_LOCATION+e.otherLocationDescription),e.tripIncludes&&r.push(t.TRIP_INCLUDES+e.tripIncludes),e.packingList&&r.push(t.PACKING_LIST+e.packingList),r.length>0&&(r=n+r.join("\n")),e.description+r}function s(t){var n,r=moment();if(t.repeat.repeating===!0){n="RRULE:FREQ="+t.repeat.repeats+";INTERVAL="+t.repeat.repeatEvery+";";var i=t.repeat.repeatOn.join(",");"dayOfMonth"==t.repeat.repeatBy?n+="BYMONTHDAY="+r.format("D")+";":t.repeat.repeatOn.length>0&&(n+="BYDAY="+i+";")}return"on"==t.repeat.ends.type?n+="UNTIL="+e.getDateString(t.repeat.ends.on,"YYYYMMDDTHHmmss",!0)+";":"after"==t.repeat.ends.type&&(n+="COUNT="+t.repeat.ends.after+";"),void 0===n?[]:[n]}function c(e,t,n){if(void 0!==n.detailsUrl)return n.detailsUrl;var i=T.detailsPage;return i+=i.indexOf("?")>-1?"&":"?",i+="id="+e.id+"&cal="+t,i.replace("@",r)}function l(e){return void 0!==e.start.date?e.start.date:e.start.dateTime}function u(e){return void 0!==e.end.date?e.end.date:e.end.dateTime}function d(e,t,n,r,i){var a;if(t&&e.id){var o=n.format("YYYYMMDDTHHmmss"),s=r.format("YYYYMMDDTHHmmss");a="http://www.google.com/calendar/event?action=TEMPLATE&text="+e.summary+"&dates="+o+"/"+s+"&details="+i+"&location="+e.location+"&trp=false"}return a}function f(e){var t="#000";return angular.forEach(T.eventTypes,function(n){n.name==e&&(t=n.color)}),t}function m(e){var t="default";return e&&e.categories?(e.categories.indexOf("Drop Ins")>-1&&(t="dropin"),e.categories.indexOf("Reserved")>-1&&(t="reserved"),e.registration.deadline&&"free"!=e.fee&&(t="premium"),e.categories.indexOf("Special Event")>-1&&(t="other"),e.categories.indexOf("Fields")>-1&&("Turf Field"==e.fieldType?t="turfField":"Grass Field"==e.fieldType&&(t="grassField")),t):t}function p(e){return e.categories}function g(e){return e instanceof Array}function v(e){var n={registration:{}};if(void 0!==e&&(e=e.split("\n")),!g(e))return{categories:null,detailsUrl:null,fee:null,registration:{url:null,deadline:null}};var r=h(e,t.CATEGORIES);if(void 0!==r?(n.categories=r.split(","),g(n.categories)||(n.categories=[n.categories])):n.categories=[],n.detailsUrl=h(e,t.DETAILS_URL),n.fee=h(e,t.FEE),n.registration.url=h(e,t.REGISTRATION_URL),n.registration.deadline=h(e,t.REGISTRATION_DEADLINE),n.recTracUrl=h(e,t.RECTRAC_URL),n.dateDescription=h(e,t.DATE_DESCRIPTION),n.iconUrl=h(e,t.UNIQUE_ICON_URL),n.dateDescription){var i=E.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1");n.dateDescription=n.dateDescription.replace(new RegExp(i,"g"),"<br />")}return n.fieldType=h(e,t.FIELD_TYPE),n.registration.startDateTime=h(e,t.START_DATE_TIME),n.registration.endDateTime=h(e,t.END_DATE_TIME),n.otherLocationDescription=h(e,t.OTHER_LOCATION),n.tripIncludes=h(e,t.TRIP_INCLUDES),n.packingList=h(e,t.PACKING_LIST),n}function h(e,t){var n;return angular.forEach(e,function(e){e.indexOf(t)>-1&&(n=e.replace(t,""))}),n}var T,E="|---|";this.init=function(e){T=e},this.getEmptyEvent=function(){return{type:null,name:null,startDate:null,startTime:"8:00am",endDate:null,endTime:"8:00am",allDay:!1,repeat:{repeating:!1,repeats:"WEEKLY",repeatEvery:1,repeatOn:[],repeatBy:"dayOfWeek",ends:{type:"never",after:null,on:null}},categories:[],location:null,description:null,detailsUrl:null,fee:null,registration:{required:!1,deadline:null},recTracId:null}},this.formatRegistration=function(e){e.startDate=e.registration.deadline,e.endDate=e.registration.deadline,e.allDay=!0;var t=o(e),n=i(e),r=a(e);return{summary:e.name,name:e.name,description:t,start:n,end:r}},this.formatForDashboard=function(e){var t=o(e),n=i(e),r=a(e),c=s(e);return{summary:e.name,name:e.name,description:t,location:e.location,start:n,end:r,recurrence:c}},this.formatForDisplay=function(e,t){var r,i,a=[];void 0!==e.description&&(a=e.description.split(n),g(a)?(r=a.shift(),i=a.shift()):r=a),i=v(i);var o,s,h,T,E=l(e),D=u(e),I=moment(E,["YYYY-MM-DDTHH:mm:ssZ"]),R=moment(D,["YYYY-MM-DDTHH:mm:ssZ"]),A=m(i),y=f(A),S=e.summary,_=i.fieldType;return i.registration&&i.registration.startDateTime&&(o=moment(i.registration.startDateTime,"MM/DD/YYYY h:mma"),s=o.format("YYYY-MM-DD")),i.registration&&i.registration.endDateTime&&(h=moment(i.registration.endDateTime,"MM/DD/YYY h:mma"),T=h.format("YYYY-MM-DD")),{id:e.id,calendarId:t,description:r,location:e.location,dateDescription:i.dateDescription,start:E,startMoment:I,end:D,endMoment:R,duration:R.diff(I,"minutes"),registrationStartMoment:o,registrationStart:s,registrationEndMoment:h,registrationEnd:T,allDay:I.isSame(R),summary:e.summary,title:S,categories:i.categories,fee:i.fee,url:c(e,t,i),googleCalUrl:d(e,t,I,R,r),recTracUrl:i.recTracUrl,iconUrl:i.iconUrl,recurrence:e.recurrence,recurringEventId:e.recurringEventId,registration:{url:i.registration.url,deadline:i.registration.deadline},fieldType:_,editable:!1,className:p(i),color:y,type:A,backgroundcolor:y,borderColor:"",textColor:"#F6F6F5",otherLocationDescription:i.otherLocationDescription,tripIncludes:i.tripIncludes,packingList:i.packingList}}}])}(),function(){"use strict";angular.module("sharedResources").service("googleApiService",["$q","eventService",function(e,t){function n(e,t){if(void 0===t||0===t.length)return!0;var n=!1;return angular.forEach(t,function(t){("Registration"==t||e.categories&&e.categories.indexOf(t.name)>-1)&&(n=!0)}),n}var r="v3";this.init=function(e){gapi.client.setApiKey(e.apiKey),t.init(e)},this.getEvent=function(n,i){var a=e.defer();return n&&i?(gapi.client.load("calendar",r).then(function(){gapi.client.calendar.events.get({calendarId:n,eventId:i}).then(function(e){var r=t.formatForDisplay(e.result,n);a.resolve(r)},function(){a.reject("Error loading calendar event.")})}),a.promise):(a.reject("Calendar not found."),a.promise)},this.getEvents=function(i,a,o,s){var c=moment(),l=[],u=[];return gapi.client.load("calendar",r).then(function(){return angular.forEach(i,function(e){if(null!==e){var r=gapi.client.calendar.events.list({calendarId:e,singleEvents:!0,timeMin:o,timeMax:s}).then(function(r){angular.forEach(r.result.items,function(r){var i=t.formatForDisplay(r,e);n(i,a)&&u.push(i)})});l.push(r)}}),e.all(l).then(function(){return u=u.sort(function(e,t){return e.startMoment.isSame(t.startMoment)?0:e.startMoment.isAfter(t.startMoment)?1:-1}),{events:u,requestTime:c}})})},this.getRecurrenceForEvent=function(t,n){var i=e.defer();return void 0===t.recurrence&&void 0!==t.recurringEventId?gapi.client.load("calendar",r).then(function(){gapi.client.calendar.events.get({calendarId:t.calendarId,eventId:t.recurringEventId}).then(function(e){i.resolve(e.result.recurrence.shift())},function(){i.reject("Original recurring event not found.")})}):n(t.recurrence),i.promise},this.authorize=function(e,t){gapi.auth.authorize(e,t)},this.checkAuth=function(e,t){return gapi.auth.authorize(e,t)},this.createEvent=function(t,n){var i=e.defer();return gapi.client.load("calendar",r).then(function(){var e=gapi.client.calendar.events.insert({calendarId:t,resource:n});e.execute(function(e){e.error?i.reject("There was an error adding event."):i.resolve()})}),i.promise}}])}();
//# sourceMappingURL=../app/maps/dashboard-b447269c.js.map