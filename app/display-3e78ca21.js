!function(){"use strict";angular.module("eventsApp",["sharedResources"])}(),function(){"use strict";angular.module("eventsApp",["sharedResources"]).filter("time",function(){return function(e){return!e||e.indexOf("T")<0||e.indexOf("-")<0?void 0:(e=e.split("T")[1].split("-")[0],moment(e,"HH:mm:ss").format("h:mm a"))}}).filter("momentTime",function(){return function(e){return e&&moment.isMoment(e)?e.format("h:mma"):void 0}}).filter("timeRange",function(){return function(e){if(e){var t=e.start,n=e.end;if(!(t.indexOf("T")<0||t.indexOf("-")<0||n.indexOf("T")<0||n.indexOf("-")<0))return t=t.split("T")[1].split("-")[0],t=moment(t,"HH:mm:ss").format("h:mm"),n=n.split("T")[1].split("-")[0],n=moment(n,"HH:mm:ss").format("h:mma"),t+"-"+n}}}).filter("date",function(){return function(e){if(e){var t;if(e.indexOf("T")>-1){var n=e.split("T");t=moment(n[0],["MM/DD","YYYY-MM-DD"])}else t=moment(e,"YYYY-MM-DD");return t.format("MM/DD")}}}).filter("fullDate",function(){return function(e){if(e){var t;if(e.indexOf("T")>-1){var n=e.split("T");t=moment(n[0],["MM/DD","YYYY-MM-DD"])}else t=moment(e,["YYYY-MM-DD","MM-DD-YYYY","MM/DD/YYYY"]);return t.format("MMMM D, YYYY")}}}).filter("arrayToString",function(){return function(e){var t=e instanceof Array;if(e&&t)return e.join(" ")}}).filter("recurrenceDays",function(){return function(e){return e&&0!==e.length?"("+e.join("/")+")":void 0}}).filter("fee",function(){return function(e){if(e){if([void 0,"","$Free","Free","free",0,"$0"].indexOf(e)>-1)return"Free";var t=e.replace(".00","");return isNaN(t)?t:(-1===t.indexOf("$")&&(t="$"+t),t)}}}).filter("arrayToIconClasses",function(){return function(e){var t=e instanceof Array;if(e&&t){var n="icon-heattimer",r="icon-swimming1",i="icon-climbing";return-1===e.indexOf(n)&&e.indexOf("Fitness")>-1&&e.push(n),-1===e.indexOf(r)&&e.indexOf("Pool")>-1&&e.push(r),-1===e.indexOf(i)&&e.indexOf("Rock Wall")>-1&&e.push(i),e.join(" ")}}}).filter("minutesToTimeString",function(){return function(e){if(e){var t="",n=Math.floor(e/60);n>0&&(t+=n,t+=n>1?" hours":" hour");var r=e%60;return n>0&&r>0&&(t+=" & "),r>0&&(t+=r+" minutes"),t}}}).filter("preventDuplicateDeadlines",function(){return function(e){if(e){var t=[];return angular.forEach(e,function(e){var n=!0;angular.forEach(t,function(t){n&&t.title==e.title&&t.start==e.start&&(n=!1)}),n&&t.push(e)}),t}}}).filter("trusted",["$sce",function(e){return function(t){return t?e.trustAsHtml(t):void 0}}])}(),function(){"use strict";angular.module("eventsApp").controller("EventsCtrl",["$scope","appService","calendarService",function(e,t,n){function r(){n.getEvents().then(function(t){if(!i.isAfter(t.requestTime)){var r=[];e.events.list=t.events.filter(function(e){return r.indexOf(e.id)>-1?!1:(r.push(e.id),!0)}).sort(function(e,t){return e.startMoment.isSame(t.startMoment)?0:e.startMoment.isAfter(t.startMoment)?1:-1}),e.eventTitles=n.getEventTitles(t.events)}})}var i=moment(),a=!0;e.events={list:[]},t.runOnLoad().then(function(e){n.init(e),a&&r()}),e.$on("overrideEventLoading",function(){a=!1})}])}(),function(){"use strict";angular.module("eventsApp").directive("bothView",["$rootScope","PLUGIN_ROOT",function(e,t){return{templateUrl:t+"/templates/display/both.html",link:function(e){e.selectedView="calendar",e.changeView=function(t){e.selectedView=t}}}}])}(),function(){"use strict";angular.module("eventsApp").directive("calendarView",["PLUGIN_ROOT","appService","calendarService",function(e,t,n){return{templateUrl:e+"/templates/display/calendarView.html",link:function(e){function r(e){void 0===e&&(e=moment().startOf("day").startOf("week")),n.getEvents(e).then(function(e){a(e.events),i(e.events)})}function i(t){void 0!==t&&(e.allEvents=t,u.fullCalendar("removeEvents"),u.fullCalendar("addEventSource",function(){var n=e.eventTitle;return n&&n!=l?(e.eventTitle!==l&&(t=t.filter(function(t){return t.title===e.eventTitle})),t):t}()))}function a(t){var n=[];angular.forEach(t,function(e){-1===n.indexOf(e.title)&&n.push(e.title)}),e.eventTitles=[l].concat(n.sort()),e.eventTypes=[];var r=t.map(function(e){return e.type});e.eventTypes=s.filter(function(e){return r.indexOf(e.name)>-1}),e.$apply()}var o,s,c=0,u=angular.element("#eventCal"),l=n.getDefaultEventTitle();e.loading=!0,e.currentEventTypes=[],e.eventTypes=[],e.eventTitles=[l],e.eventTitle=l,e.$emit("overrideEventLoading"),u.fullCalendar({handleWindowResize:!0,defaultView:"agendaWeek",allDaySlot:!1,minTime:"06:00:00",scrollTime:"07:00:00",aspectRatio:.9,eventAfterAllRender:function(t){e.loading=!t}}),t.runOnLoad().then(function(e){s=e.eventTypes,r()}),e.$watch("eventTitle",function(){e.eventTitle&&i(e.allEvents)}),e.$watch("eventTitles",function(){-1==e.eventTitles.indexOf(e.eventTitle)&&(e.eventTitle=l)}),angular.element(".fc-next-button").click(function(){o=moment().startOf("week").add(++c,"weeks"),r(o)}),angular.element(".fc-prev-button").click(function(){o=moment().startOf("week").add(--c,"weeks"),r(o)}),angular.element(".fc-today-button").click(function(){c=0,r()})}}}])}(),function(){"use strict";angular.module("eventsApp").directive("clinicsView",["PLUGIN_ROOT","appService","calendarService",function(e,t,n){return{templateUrl:e+"/templates/display/clinics.html",link:function(e){e.$emit("overrideEventLoading"),t.runOnLoad().then(function(e){var t=moment().startOf("day"),r=t.clone().add(3,"months");return n.init(e),n.getEvents(t,r)}).then(function(t){e.events.list=t.events.sort(function(e,t){return e.startMoment.isSame(t.startMoment)?0:e.startMoment.isAfter(t.startMoment)?1:-1})})}}}])}(),function(){"use strict";angular.module("eventsApp").directive("deadlinesView",["PLUGIN_ROOT","appService","calendarService",function(e,t,n){return{templateUrl:e+"/templates/display/deadlines.html",link:function(e){e.$emit("overrideEventLoading"),t.runOnLoad().then(function(t){n.init(t),n.getRegistrationDeadlines().then(function(t){e.events.list=t.events,0===t.events.length&&(e.noEventsToday=!0),e.$apply()})})}}}])}(),function(){"use strict";angular.module("eventsApp").directive("detailsView",["PLUGIN_ROOT","appService","calendarService","dateService",function(e,t,n,r){return{templateUrl:e+"/templates/display/details.html",link:function(e){function i(t){n.getRecurrence(t).then(function(t){if(t){var n=t.split("BYDAY=").pop().split(",");if(e.recurrence=r.getDaysString(n),t.indexOf("UNTIL")>-1){var i="";angular.forEach(t.split(";"),function(e){e.indexOf("UNTIL")>-1&&(i=e)}),e.sessionEndsOn=moment(i,"YYYYMMDDTHHmmSSZ").format("MMMM D, YYYY")}}})}e.noEventFound=!1,t.runOnLoad().then(function(){n.getEvent().then(function(t){if(e.event=t,t.recurrence)e.recurrence=t.recurrence;else if(t.recurringEventId)i(t);else if(void 0!==t){var n=[t.startMoment.format("dd").toUpperCase()];e.recurrence=r.getDaysString(n)}else e.noEventFound=!0},function(){e.noEventFound=!0})})}}}])}(),function(){"use strict";angular.module("eventsApp").directive("dropinsView",["PLUGIN_ROOT","appService","calendarService",function(e,t,n){return{templateUrl:e+"/templates/display/dropins.html",link:function(e){e.$emit("overrideEventLoading"),e.noEventsToday=!1,t.runOnLoad().then(function(){n.getDropins().then(function(t){0===t.events.length?e.noEventsToday=!0:(e.events.list=t.events,e.$apply())})}),e.filterDropins=function(e){return e.categories.indexOf("Drop Ins")>-1?e:void 0}}}}])}(),function(){"use strict";angular.module("eventsApp").directive("fieldsView",["PLUGIN_ROOT","appService",function(e,t){return{templateUrl:e+"/templates/display/fields.html",link:function(e){t.runOnLoad().then(function(t){angular.forEach(t.eventTypes,function(t){"turfField"==t.name?e.turfFieldColor=t.color:"grassField"==t.name&&(e.grassFieldColor=t.color)})})}}}])}(),function(){"use strict";angular.module("eventsApp").directive("listView",["PLUGIN_ROOT",function(e){return{templateUrl:e+"/templates/display/list.html"}}])}(),function(){"use strict";angular.module("eventsApp").directive("tripNotes",["PLUGIN_ROOT",function(e){return{templateUrl:e+"/templates/display/tripNotes.html"}}])}(),function(){"use strict";angular.module("eventsApp").directive("tripsView",["PLUGIN_ROOT","appService","calendarService",function(e,t,n){return{templateUrl:e+"/templates/display/trips.html",link:function(e){e.$emit("overrideEventLoading"),t.runOnLoad().then(function(e){var t=moment().startOf("day"),r=moment().startOf("day").add(6,"months");return n.init(e),n.getEvents(t,r)}).then(function(t){e.events.list=t.events})}}}])}(),function(){"use strict";angular.module("eventsApp").service("calendarService",["$rootScope","$filter","googleApiService","dateService",function(e,t,n,r){function i(){var e=[];return angular.forEach(o.calendars,function(t){u.indexOf(t.name)>-1&&e.push(t.id)}),e}function a(e,t,i){var a=e?e:s;return t||(t=moment().startOf("week").startOf("day")),i||(i=t.clone().add(7,"days")),t=r.getDateTimeString(t.format("MM/DD/YYYY h:mma")),i=r.getDateTimeString(i.format("MM/DD/YYYY h:mma")),n.getEvents(c,a,t,i)}var o,s,c,u=[],l="Filter By Class...";this.init=function(e){o=e,u=[],angular.forEach(o.view,function(e){u.push(e.trim())}),s=o.categories,c=i()},this.getDefaultEventTitle=function(){return l},this.getEvents=function(e,t){return a(s,e,t)},this.getEvent=function(){return n.getEvent(o.calendarId,o.eventId)},this.getRegistrationDeadlines=function(){var e=["Registration"],t=moment().subtract(1,"day").endOf("day"),n=moment().add(1,"months");return a(e,t,n)},this.getRecurrence=function(e){return n.getRecurrenceForEvent(e)},this.getDropins=function(){var e=[];angular.forEach(o.view,function(t){e.push({name:t,parent:""})});var t=moment().startOf("day"),n=moment().endOf("day");return a(e,t,n)},this.getEventTitles=function(e){var n=[l];return e=t("orderBy")(e,"title"),angular.forEach(e,function(e){e.allDay||-1!=n.indexOf(e.title)||n.push(e.title)}),n}}])}(),function(){"use strict";angular.module("sharedResources",[]).constant("PLUGIN_ROOT","/wp-content/plugins/bsu_events_manager").constant("SEPARATOR","\n\n------------------------------\n").constant("AT_SIGN_REPLACEMENT","%%at%%").constant("FIELDS",{CATEGORIES:"Categories: ",DETAILS_URL:"Details URL: ",FEE:"Fee: ",RECTRAC_URL:"Registration URL: ",REGISTRATION_URL:"Registration URL: ",REGISTRATION_DEADLINE:"Registration deadline: ",DATE_DESCRIPTION:"Date description: ",FIELD_TYPE:"Field type: ",UNIQUE_ICON_URL:"Unique icon url: ",START_DATE_TIME:"Event start datetime: ",END_DATE_TIME:"Event end datetime: ",OTHER_LOCATION:"Location: ",TRIP_INCLUDES:"Trip includes: ",PACKING_LIST:"Packing list: "}).filter("unique",function(){return function(e,t){var n=[],r=[];return angular.forEach(e,function(e){var i=e;angular.forEach(t.split("."),function(e){i=i[e]}),-1===r.indexOf(i)&&(r.push(i),n.push(e))}),n}})}(),function(){"use strict";angular.module("sharedResources").controller("MainCtrl",["$scope","$timeout","appService",function(e,t,n){function r(){t(function(){void 0===gapi||void 0===gapi.client||void 0===gapi.client.setApiKey?r():n.appIsLoaded()},5)}var i;e.categories=[],e.init=function(t){i=angular.fromJson(t),e.loading=!1,e.categories=i.categories.all,e.view=i.view,e.detailsPage=i.detailsPage,e.calendarId=i.calendarId,e.eventId=i.eventId,e.settings=i,n.init(i),r()}}])}(),function(){"use strict";angular.module("sharedResources").directive("loading",function(){return{template:'<div class="bsuEventSpinner"></loading>'}})}(),function(){"use strict";angular.module("sharedResources").directive("selectOnClick",function(){return{restrict:"A",link:function(e,t){t.on("click",function(){this.select()})}}})}(),function(){"use strict";angular.module("sharedResources").service("anchorSmoothScroll",["$document","$window",function(e,t){function n(e,t){return e.pageYOffset?e.pageYOffset:t.documentElement&&t.documentElement.scrollTop?t.documentElement.scrollTop:t.body.scrollTop?t.body.scrollTop:0}function r(e,t){for(var n=t.offsetTop,r=t;r.offsetParent&&r.offsetParent!=e.body;)r=r.offsetParent,n+=r.offsetTop;return n}function i(e,t,n,r){for(var i=0,a=Math.round(r/25),o=e+a,s=e;t>s;s+=a)setTimeout("window.scrollTo(0, "+o+")",i*n),o+=a,o>t&&(o=t),i++}function a(e,t,n,r){for(var i=0,a=Math.round(r/25),o=e-a,s=e;s>t;s-=a)setTimeout("window.scrollTo(0, "+o+")",i*n),o-=a,t>o&&(o=t),i++}var o=e[0],s=t,c=this;this.scrollToTop=function(){c.scrollTo(o.getElementsByTagName("head")[0])},this.scrollTo=function(e){if(e){var t=n(s,o),c=r(o,e),u=c>t?c-t:t-c;if(100>u)this.scrollToTop(c);else{var l=Math.round(u/80),d=l>20?20:l;c>t?i(t,c,d,u):a(t,c,d,u)}}}}])}(),function(){"use strict";angular.module("sharedResources").service("appService",["$http","$q","googleApiService","PLUGIN_ROOT","AT_SIGN_REPLACEMENT",function(e,t,n,r,i){function a(){var e=[];angular.forEach(o.categories.all,function(t){e.push({name:t.name,parent:t.name}),angular.forEach(t.children,function(n){e.push({name:n,parent:t.name})})}),o.calendarId&&(o.calendarId=o.calendarId.replace(i,"@"));var r=o.categories.view,a=[];void 0!==r&&r.length>0&&(a="all"===r?e:r.split(","));var s={categories:e,view:a,calendarId:o.calendarId,eventId:o.eventId,clientId:o.clientId,detailsPage:o.detailsPage,calendars:o.calendars,eventTypes:o.eventTypes,locations:o.locations,staticCategories:o.staticCategories};void 0!==o.icons&&(s.icons=o.icons),n.init(o);var c=t.defer();return c.resolve(s),c.promise}var o,s=t.defer();this.init=function(e){o=e},this.runOnLoad=function(){return s.promise},this.appIsLoaded=function(){s.resolve(a())}}])}(),function(){"use strict";angular.module("sharedResources").service("dateService",function(){function e(e){return 10>e?"0"+e:e}this.getDateString=function(e,t,n){void 0===t&&(t="YYYY-MM-DD");var r=moment(e,["MM/DD/YYYY"]).format(t);return void 0!==n&&(r+="Z"),r},this.getDateTimeString=function(t,n){var r=moment().isDST()?"-06:00":"-07:00";return moment(e(t)+e(n),["MM/DD/YYYY h:mma"]).format("YYYY-MM-DDTHH:mm:ss"+r)},this.getDaysString=function(e){var t=[];return angular.forEach(e,function(e){switch(e){case"MO":t.push("M");break;case"TU":t.push("Tu");break;case"WE":t.push("W");break;case"TH":t.push("Th");break;case"FR":t.push("F");break;case"SA":t.push("Sa");break;case"SU":t.push("Su")}}),t.join("/")}})}(),function(){"use strict";angular.module("sharedResources").service("eventService",["dateService","FIELDS","SEPARATOR","AT_SIGN_REPLACEMENT",function(e,t,n,r){function i(t){var n={timeZone:"America/Boise"};return t.allDay===!0?n.date=e.getDateString(t.startDate):n.dateTime=e.getDateTimeString(t.startDate,t.startTime),n}function a(t){var n={timeZone:"America/Boise"};return t.allDay===!0?n.date=e.getDateString(t.endDate):n.dateTime=e.getDateTimeString(t.endDate,t.endTime),n}function o(e){var r=[];if(e.categories.length>0&&r.push(t.CATEGORIES+e.categories.toString().replace(/- /g,"")),null!==e.detailsUrl&&r.push(t.DETAILS_URL+e.detailsUrl),r.push(null!==e.fee?[void 0,0,"$0","free","Free"].indexOf(e.fee)>-1?t.FEE+"Free":t.FEE+"$"+e.fee.replace("$",""):t.FEE+"free"),null!==e.recTracId){var i="https://reconline.boisestate.edu/wbwsc/webtrac.wsc/wbsearch.html?xxsearch=yes&xxactivitynumber="+e.recTracId;r.push(t.RECTRAC_URL+i)}if(e.registration.required===!0&&r.push(t.REGISTRATION_DEADLINE+e.registration.deadline),e.dateDescription){var a=e.dateDescription.replace(/\n/g,E);r.push(t.DATE_DESCRIPTION+a)}return e.fieldType&&r.push(t.FIELD_TYPE+e.fieldType),e.iconUrl&&r.push(t.UNIQUE_ICON_URL+e.iconUrl),e.registration.required&&(r.push(t.START_DATE_TIME+e.startDate+" "+e.startTime),r.push(t.END_DATE_TIME+e.endDate+" "+e.endTime)),e.otherLocationDescription&&r.push(t.OTHER_LOCATION+e.otherLocationDescription),e.tripIncludes&&r.push(t.TRIP_INCLUDES+e.tripIncludes),e.packingList&&r.push(t.PACKING_LIST+e.packingList),r.length>0&&(r=n+r.join("\n")),e.description+r}function s(t){var n,r=moment();if(t.repeat.repeating===!0){n="RRULE:FREQ="+t.repeat.repeats+";INTERVAL="+t.repeat.repeatEvery+";";var i=t.repeat.repeatOn.join(",");"dayOfMonth"==t.repeat.repeatBy?n+="BYMONTHDAY="+r.format("D")+";":t.repeat.repeatOn.length>0&&(n+="BYDAY="+i+";")}return"on"==t.repeat.ends.type?n+="UNTIL="+e.getDateString(t.repeat.ends.on,"YYYYMMDDTHHmmss",!0)+";":"after"==t.repeat.ends.type&&(n+="COUNT="+t.repeat.ends.after+";"),void 0===n?[]:[n]}function c(e,t,n){if(void 0!==n.detailsUrl)return n.detailsUrl;var i=h.detailsPage;return i+=i.indexOf("?")>-1?"&":"?",i+="id="+e.id+"&cal="+t,i.replace("@",r)}function u(e){return void 0!==e.start.date?e.start.date:e.start.dateTime}function l(e){return void 0!==e.end.date?e.end.date:e.end.dateTime}function d(e,t,n,r,i){var a;if(t&&e.id){var o=n.format("YYYYMMDDTHHmmss"),s=r.format("YYYYMMDDTHHmmss");a="http://www.google.com/calendar/event?action=TEMPLATE&text="+e.summary+"&dates="+o+"/"+s+"&details="+i+"&location="+e.location+"&trp=false"}return a}function f(e){var t="#000";return angular.forEach(h.eventTypes,function(n){n.name==e&&(t=n.color)}),t}function m(e){var t="default";return e&&e.categories?(e.categories.indexOf("Drop Ins")>-1&&(t="dropin"),e.categories.indexOf("Reserved")>-1&&(t="reserved"),e.registration.deadline&&"free"!=e.fee&&(t="premium"),e.categories.indexOf("Special Event")>-1&&(t="other"),e.categories.indexOf("Fields")>-1&&("Turf Field"==e.fieldType?t="turfField":"Grass Field"==e.fieldType&&(t="grassField")),t):t}function p(e){return e.categories}function v(e){return e instanceof Array}function g(e){var n={registration:{}};if(void 0!==e&&(e=e.split("\n")),!v(e))return{categories:null,detailsUrl:null,fee:null,registration:{url:null,deadline:null}};var r=T(e,t.CATEGORIES);if(void 0!==r?(n.categories=r.split(","),v(n.categories)||(n.categories=[n.categories])):n.categories=[],n.detailsUrl=T(e,t.DETAILS_URL),n.fee=T(e,t.FEE),n.registration.url=T(e,t.REGISTRATION_URL),n.registration.deadline=T(e,t.REGISTRATION_DEADLINE),n.recTracUrl=T(e,t.RECTRAC_URL),n.dateDescription=T(e,t.DATE_DESCRIPTION),n.iconUrl=T(e,t.UNIQUE_ICON_URL),n.dateDescription){var i=E.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1");n.dateDescription=n.dateDescription.replace(new RegExp(i,"g"),"<br />")}return n.fieldType=T(e,t.FIELD_TYPE),n.registration.startDateTime=T(e,t.START_DATE_TIME),n.registration.endDateTime=T(e,t.END_DATE_TIME),n.otherLocationDescription=T(e,t.OTHER_LOCATION),n.tripIncludes=T(e,t.TRIP_INCLUDES),n.packingList=T(e,t.PACKING_LIST),n}function T(e,t){var n;return angular.forEach(e,function(e){e.indexOf(t)>-1&&(n=e.replace(t,""))}),n}var h,E="|---|";this.init=function(e){h=e},this.getEmptyEvent=function(){return{type:null,name:null,startDate:null,startTime:"8:00am",endDate:null,endTime:"8:00am",allDay:!1,repeat:{repeating:!1,repeats:"WEEKLY",repeatEvery:1,repeatOn:[],repeatBy:"dayOfWeek",ends:{type:"never",after:null,on:null}},categories:[],location:null,description:null,detailsUrl:null,fee:null,registration:{required:!1,deadline:null},recTracId:null}},this.formatRegistration=function(e){e.startDate=e.registration.deadline,e.endDate=e.registration.deadline,e.allDay=!0;var t=o(e),n=i(e),r=a(e);return{summary:e.name,name:e.name,description:t,start:n,end:r}},this.formatForDashboard=function(e){var t=o(e),n=i(e),r=a(e),c=s(e);return{summary:e.name,name:e.name,description:t,location:e.location,start:n,end:r,recurrence:c}},this.formatForDisplay=function(e,t){var r,i,a=[];void 0!==e.description&&(a=e.description.split(n),v(a)?(r=a.shift(),i=a.shift()):r=a),i=g(i);var o,s,T,h,E=u(e),D=l(e),I=moment(E,["YYYY-MM-DDTHH:mm:ssZ"]),O=moment(D,["YYYY-MM-DDTHH:mm:ssZ"]),Y=m(i),R=f(Y),M=e.summary,y=i.fieldType;return i.registration&&i.registration.startDateTime&&(o=moment(i.registration.startDateTime,"MM/DD/YYYY h:mma"),s=o.format("YYYY-MM-DD")),i.registration&&i.registration.endDateTime&&(T=moment(i.registration.endDateTime,"MM/DD/YYY h:mma"),h=T.format("YYYY-MM-DD")),{id:e.id,calendarId:t,description:r,location:e.location,dateDescription:i.dateDescription,start:E,startMoment:I,end:D,endMoment:O,duration:O.diff(I,"minutes"),registrationStartMoment:o,registrationStart:s,registrationEndMoment:T,registrationEnd:h,allDay:I.isSame(O),summary:e.summary,title:M,categories:i.categories,fee:i.fee,url:c(e,t,i),googleCalUrl:d(e,t,I,O,r),recTracUrl:i.recTracUrl,iconUrl:i.iconUrl,recurrence:e.recurrence,recurringEventId:e.recurringEventId,registration:{url:i.registration.url,deadline:i.registration.deadline},fieldType:y,editable:!1,className:p(i),color:R,type:Y,backgroundcolor:R,borderColor:"",textColor:"#F6F6F5",otherLocationDescription:i.otherLocationDescription,tripIncludes:i.tripIncludes,packingList:i.packingList}}}])}(),function(){"use strict";angular.module("sharedResources").service("googleApiService",["$q","eventService",function(e,t){function n(e,t){if(void 0===t||0===t.length)return!0;var n=!1;return angular.forEach(t,function(t){("Registration"==t||e.categories&&e.categories.indexOf(t.name)>-1)&&(n=!0)}),n}var r="v3";this.init=function(e){gapi.client.setApiKey(e.apiKey),t.init(e)},this.getEvent=function(n,i){var a=e.defer();return n&&i?(gapi.client.load("calendar",r).then(function(){gapi.client.calendar.events.get({calendarId:n,eventId:i}).then(function(e){var r=t.formatForDisplay(e.result,n);a.resolve(r)},function(){a.reject("Error loading calendar event.")})}),a.promise):(a.reject("Calendar not found."),a.promise)},this.getEvents=function(i,a,o,s){var c=moment(),u=[],l=[];return gapi.client.load("calendar",r).then(function(){return angular.forEach(i,function(e){if(null!==e){var r=gapi.client.calendar.events.list({calendarId:e,singleEvents:!0,timeMin:o,timeMax:s}).then(function(r){angular.forEach(r.result.items,function(r){var i=t.formatForDisplay(r,e);n(i,a)&&l.push(i)})});u.push(r)}}),e.all(u).then(function(){return l=l.sort(function(e,t){return e.startMoment.isSame(t.startMoment)?0:e.startMoment.isAfter(t.startMoment)?1:-1}),{events:l,requestTime:c}})})},this.getRecurrenceForEvent=function(t,n){var i=e.defer();return void 0===t.recurrence&&void 0!==t.recurringEventId?gapi.client.load("calendar",r).then(function(){gapi.client.calendar.events.get({calendarId:t.calendarId,eventId:t.recurringEventId}).then(function(e){i.resolve(e.result.recurrence.shift())},function(){i.reject("Original recurring event not found.")})}):n(t.recurrence),i.promise},this.authorize=function(e,t){gapi.auth.authorize(e,t)},this.checkAuth=function(e,t){return gapi.auth.authorize(e,t)},this.createEvent=function(t,n){var i=e.defer();return gapi.client.load("calendar",r).then(function(){var e=gapi.client.calendar.events.insert({calendarId:t,resource:n});e.execute(function(e){e.error?i.reject("There was an error adding event."):i.resolve()})}),i.promise}}])}();
//# sourceMappingURL=../app/maps/display-3e78ca21.js.map